# WPS å¡ç‰‡æ¶ˆæ¯æµ‹è¯•ç”¨ä¾‹

## ğŸ“Œ å¡ç‰‡æ¶ˆæ¯æ ¼å¼è¯´æ˜

WPSæœºå™¨äººæ”¯æŒç»“æ„åŒ–çš„å¡ç‰‡æ¶ˆæ¯ï¼ŒåŒ…å«ä»¥ä¸‹ä¸»è¦éƒ¨åˆ†ï¼š
- `header`: å¡ç‰‡å¤´éƒ¨ï¼ˆæ ‡é¢˜ã€å‰¯æ ‡é¢˜ï¼‰
- `elements`: å¡ç‰‡å†…å®¹å…ƒç´ æ•°ç»„
- `i18n`: å›½é™…åŒ–å†…å®¹ï¼ˆå¯é€‰ï¼‰

## ğŸ¯ æµ‹è¯•ç”¨ä¾‹

### ç”¨ä¾‹1ï¼šå®Œæ•´æ ¼å¼å¡ç‰‡ï¼ˆåŒ…å«msgtypeï¼‰

ç›´æ¥åœ¨æ¶ˆæ¯å†…å®¹æ¡†ä¸­ç²˜è´´ä»¥ä¸‹JSONï¼š

```json
{
  "msgtype": "card",
  "card": {
    "header": {
      "title": {
        "tag": "text",
        "content": {
          "type": "plainText",
          "text": "æµ‹è¯•æ ‡é¢˜"
        }
      },
      "subtitle": {
        "tag": "text",
        "content": {
          "type": "plainText",
          "text": "æµ‹è¯•å‰¯æ ‡é¢˜"
        }
      }
    },
    "elements": [
      {
        "tag": "text",
        "content": {
          "type": "plainText",
          "text": "è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯"
        }
      }
    ]
  }
}
```

### ç”¨ä¾‹2ï¼šä»…cardå†…å®¹ï¼ˆä¸åŒ…å«msgtypeï¼‰

ç³»ç»Ÿä¼šè‡ªåŠ¨æ·»åŠ msgtypeå­—æ®µï¼š

```json
{
  "header": {
    "title": {
      "tag": "text",
      "content": {
        "type": "plainText",
        "text": "é€šçŸ¥"
      }
    }
  },
  "elements": [
    {
      "tag": "text",
      "content": {
        "type": "markdown",
        "text": "**é‡è¦é€šçŸ¥**\n\nç³»ç»Ÿå°†äºä»Šæ™šç»´æŠ¤"
      }
    }
  ]
}
```

### ç”¨ä¾‹3ï¼šå¸¦å›½é™…åŒ–çš„å¡ç‰‡æ¶ˆæ¯

æ”¯æŒå¤šè¯­è¨€æ˜¾ç¤ºï¼š

```json
{
  "msgtype": "card",
  "card": {
    "header": {
      "title": {
        "tag": "text",
        "content": {
          "type": "plainText",
          "text": "æ ‡é¢˜"
        }
      },
      "subtitle": {
        "tag": "text",
        "content": {
          "type": "plainText",
          "text": "å‰¯æ ‡é¢˜"
        }
      }
    },
    "elements": [
      {
        "tag": "text",
        "content": {
          "type": "markdown",
          "text": "æ™®é€šæ–‡æœ¬"
        }
      }
    ],
    "i18n": {
      "zh-TW": {
        "header": {
          "title": {
            "tag": "text",
            "content": {
              "type": "plainText",
              "text": "æ¨™é¡Œ"
            }
          },
          "subtitle": {
            "tag": "text",
            "content": {
              "type": "plainText",
              "text": "å‰¯æ¨™é¡Œ"
            }
          }
        },
        "elements": [
          {
            "tag": "text",
            "content": {
              "type": "markdown",
              "text": "æ™®é€šæ–‡æœ¬"
            }
          }
        ]
      },
      "en-US": {
        "header": {
          "title": {
            "tag": "text",
            "content": {
              "type": "plainText",
              "text": "Title"
            }
          },
          "subtitle": {
            "tag": "text",
            "content": {
              "type": "plainText",
              "text": "Subtitle"
            }
          }
        },
        "elements": [
          {
            "tag": "text",
            "content": {
              "type": "markdown",
              "text": "Common text"
            }
          }
        ]
      }
    }
  }
}
```

### ç”¨ä¾‹4ï¼šç®€å•è¡¨å•æ–¹å¼

å¦‚æœä¸æƒ³å†™JSONï¼Œå¯ä»¥ä½¿ç”¨è¡¨å•å­—æ®µï¼š
- **å¡ç‰‡æ ‡é¢˜**: è¾“å…¥æ ‡é¢˜æ–‡å­—
- **å¡ç‰‡å†…å®¹**: è¾“å…¥å†…å®¹æ–‡å­—

ç³»ç»Ÿä¼šè‡ªåŠ¨æ„é€ ä¸ºWPSå¡ç‰‡æ ¼å¼ï¼š
```json
{
  "msgtype": "card",
  "card": {
    "header": {
      "title": {
        "tag": "text",
        "content": {
          "type": "plainText",
          "text": "æ‚¨è¾“å…¥çš„æ ‡é¢˜"
        }
      }
    },
    "elements": [
      {
        "tag": "text",
        "content": {
          "type": "plainText",
          "text": "æ‚¨è¾“å…¥çš„å†…å®¹"
        }
      }
    ]
  }
}
```

## ğŸ” æ”¯æŒçš„å†…å®¹ç±»å‹

### æ–‡æœ¬ç±»å‹
- `plainText`: çº¯æ–‡æœ¬
- `markdown`: Markdownæ ¼å¼

### å…ƒç´ æ ‡ç­¾
- `text`: æ–‡æœ¬å…ƒç´ 
- `image`: å›¾ç‰‡å…ƒç´ ï¼ˆå¦‚æ”¯æŒï¼‰
- `button`: æŒ‰é’®å…ƒç´ ï¼ˆå¦‚æ”¯æŒï¼‰

## ğŸ“ ä½¿ç”¨è¯´æ˜

### å‘é€æ­¥éª¤

1. **é€‰æ‹©æ¶ˆæ¯ç±»å‹**ï¼šé€‰æ‹©"å¡ç‰‡æ¶ˆæ¯"

2. **è¾“å…¥JSONå†…å®¹**ï¼š
   - æ–¹å¼ä¸€ï¼šç²˜è´´å®Œæ•´çš„JSONï¼ˆåŒ…å«msgtypeå’Œcardï¼‰
   - æ–¹å¼äºŒï¼šåªç²˜è´´cardçš„å†…å®¹ï¼ˆheaderå’Œelementsï¼‰
   - æ–¹å¼ä¸‰ï¼šä½¿ç”¨è¡¨å•å­—æ®µï¼ˆæ ‡é¢˜å’Œå†…å®¹ï¼‰

3. **ç‚¹å‡»å‘é€**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†JSONæ ¼å¼å¹¶å‘é€

### æ³¨æ„äº‹é¡¹

1. **JSONæ ¼å¼**ï¼š
   - å¿…é¡»æ˜¯æœ‰æ•ˆçš„JSONæ ¼å¼
   - æ³¨æ„å¼•å·ä½¿ç”¨åŒå¼•å·`"`ï¼Œä¸èƒ½ç”¨å•å¼•å·`'`
   - æœ€åä¸€ä¸ªå±æ€§åé¢ä¸è¦åŠ é€—å·

2. **å¿…éœ€å­—æ®µ**ï¼š
   - è‡³å°‘éœ€è¦`header`æˆ–`elements`å…¶ä¸­ä¹‹ä¸€
   - `header.title`æ˜¯æ¨èåŒ…å«çš„

3. **æ–‡æœ¬ç±»å‹**ï¼š
   - `plainText`: æ˜¾ç¤ºçº¯æ–‡æœ¬
   - `markdown`: æ”¯æŒMarkdownæ ¼å¼ï¼ˆåŠ ç²—ã€é“¾æ¥ç­‰ï¼‰

## ğŸ§ª æµ‹è¯•å»ºè®®

### æµ‹è¯•1ï¼šåŸºç¡€å¡ç‰‡
ä½¿ç”¨ç”¨ä¾‹1çš„ç®€å•æ ¼å¼ï¼ŒéªŒè¯åŸºæœ¬åŠŸèƒ½

### æµ‹è¯•2ï¼šMarkdownå†…å®¹
åœ¨elementsä¸­ä½¿ç”¨markdownç±»å‹ï¼Œæµ‹è¯•æ ¼å¼åŒ–æ–‡æœ¬

### æµ‹è¯•3ï¼šå®Œæ•´å¡ç‰‡
ä½¿ç”¨card_message_case.jsonçš„å®Œæ•´æ ¼å¼ï¼Œæµ‹è¯•å›½é™…åŒ–

### æµ‹è¯•4ï¼šè¡¨å•è¾“å…¥
ä¸ä½¿ç”¨JSONï¼Œç›´æ¥åœ¨è¡¨å•å­—æ®µè¾“å…¥ï¼Œæµ‹è¯•è‡ªåŠ¨æ„é€ 

## âš ï¸ å¸¸è§é”™è¯¯

### é”™è¯¯1ï¼šJSONæ ¼å¼é”™è¯¯
```
æ¶ˆæ¯: å¡ç‰‡JSONæ ¼å¼é”™è¯¯: Expecting property name enclosed in double quotes
```
**åŸå› **ï¼šJSONæ ¼å¼ä¸æ­£ç¡®ï¼Œå¯èƒ½æ˜¯ï¼š
- ä½¿ç”¨äº†å•å¼•å·
- å¤šä½™çš„é€—å·
- ç¼ºå°‘å¼•å·

**è§£å†³**ï¼šä½¿ç”¨JSONéªŒè¯å·¥å…·æ£€æŸ¥æ ¼å¼

### é”™è¯¯2ï¼šç¼ºå°‘å¿…éœ€å­—æ®µ
```
HTTP 400: {"result":"InvalidArgument","msg":"..."}
```
**åŸå› **ï¼šå¡ç‰‡ç»“æ„ä¸ç¬¦åˆWPSè¦æ±‚

**è§£å†³**ï¼šç¡®ä¿åŒ…å«headeræˆ–elements

### é”™è¯¯3ï¼šå†…å®¹ä¸ºç©º
```
HTTP 400: {"result":"InvalidArgument","msg":"Card message is empty"}
```
**åŸå› **ï¼šå¡ç‰‡å†…å®¹ä¸ºç©º

**è§£å†³**ï¼šç¡®ä¿header.titleæˆ–elementsæœ‰å†…å®¹

## ğŸ“š å‚è€ƒèµ„æº

- [WPSå¼€æ”¾å¹³å° - æ¶ˆæ¯å¡ç‰‡æ–‡æ¡£](https://open.wps.cn/documents/app-integration-dev/guide/card/card-summary)
- JSONåœ¨çº¿éªŒè¯å·¥å…·ï¼šhttps://jsonlint.com/

## ğŸ”„ ç‰ˆæœ¬å†å²

- v2.0 (2026-01-30): ä¿®å¤å¡ç‰‡æ¶ˆæ¯æ”¯æŒï¼Œæ­£ç¡®è§£æWPSå¡ç‰‡æ ¼å¼
- v1.0: åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€å¡ç‰‡æ”¯æŒ
